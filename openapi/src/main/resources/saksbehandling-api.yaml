openapi: 3.0.3
info:
  title: Saksbehandling API
  version: 1.0.0
  description: Et API for å administrere oppgaver og deres tilstandsoverganger.
servers:
  - url: https://dp-saksbehandling.intern.dev.nav.no
    description: dev
  - url: https://dp-saksbehandling # Service discovery internt i clusteret
    description: prod
paths:
  /innsending/{behandlingId}/ferdigstill:
    put:
      summary: Ferdigstill innsending for en gitt id
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FerdigstillInnsendingRequest'
      parameters:
        - in: path
          name: behandlingId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Innsending ferdigstilt
        '404':
          description: Innsending informasjon for behandlingId ble ikke funnet
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
  /innsending/{behandlingId}:
    get:
      summary: Hent innsending for en gitt id
      parameters:
        - in: path
          name: behandlingId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Vellykket respons med innsending
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Innsending'
        '404':
          description: Innsending informasjon for behandlingId ble ikke funnet
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /oppgave:
    get:
      summary: Hent alle oppgaver med status Klar til behandling
      parameters:
        - in: query
          name: rettighet
          description: Filtrer på rettighetsknagger (f.eks. "Ordinær", "Verneplikt", "Permittert")
          required: false
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
          example: ["Ordinær", "Verneplikt"]
        - in: query
          name: soknadsresultat
          description: Filtrer på søknadsresultatknagger (f.eks. "Avslag", "Innvilgelse")
          required: false
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
          example: ["Avslag", "Innvilgelse"]
        - in: query
          name: avslagsgrunn
          description: Filtrer på avslagsgrunner (f.eks. "Minsteinntekt", "Arbeidstid")
          required: false
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
          example: ["Minsteinntekt"]
        - in: query
          name: gjenopptak
          description: Filtrer på gjenopptakknagger
          required: false
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
          example: ["Gjenopptak"]
        - in: query
          name: paa_vent
          description: Filtrer på på-vent årsaker (f.eks. "Avvent svar", "Avvent dokumentasjon")
          required: false
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
          example: ["Avvent svar"]
        - in: query
          name: avbrutt_grunn
          description: Filtrer på avbruddsårsaker
          required: false
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
          example: ["Trukket søknad"]
        - in: query
          name: ettersending
          description: Filtrer på ettersendinger
          required: false
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
        - in: query
          name: tilstand
          required: false
          style: form
          explode: true
          schema:
            type: array
            items:
              $ref: '#/components/schemas/OppgaveTilstand'
        - in: query
          name: utlostAv
          required: false
          style: form
          explode: true
          schema:
            type: array
            items:
              $ref: '#/components/schemas/UtlostAvType'
        - in: query
          name: fom
          required: false
          schema:
            type: string
            format: date
        - in: query
          name: tom
          required: false
          schema:
            type: string
            format: date
        - in: query
          name: mineOppgaver
          required: false
          schema:
            type: boolean
        - in: query
          name: antallOppgaver
          required: false
          schema:
            type: integer
        - in: query
          name: side
          required: false
          schema:
            type: integer
      responses:
        '200':
          description: Vellykket respons med en liste over oppgaver
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OppgaveOversiktResultat'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /oppgave/neste:
    put:
      summary: Hent neste oppgave og tildel denne til saksbehandler
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NesteOppgave'
      responses:
        '200':
          description: Vellykket respons med detaljer om oppgaven som tildeles
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Oppgave'
        '404':
          description: Ingen flere oppgaver å behandle akkurat nå
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /oppgave/{oppgaveId}:
    get:
      summary: Hent en oppgave ved hjelp av dens ID
      parameters:
        - in: path
          name: oppgaveId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Vellykket respons med detaljer om oppgaven
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Oppgave'
        '404':
          description: Oppgaven ble ikke funnet
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /oppgave/{oppgaveId}/notat:
    put:
      summary: Legg til et notat på en oppgave
      parameters:
        - in: path
          name: oppgaveId
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NotatRequest'

      responses:
        '200':
          description: Notatet ble lagt til
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LagreNotatResponse'
        '404':
          description: Oppgaven ble ikke funnet
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        '409':
          description: Notat kan ikke lagres på oppgaven i denne tilstanden
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
    delete:
      summary: Slett notat på en oppgave
      parameters:
        - in: path
          name: oppgaveId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Notatet slettet
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LagreNotatResponse'
        '404':
          description: Oppgaven ble ikke funnet
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        '409':
          description: Notat kan ikke slettes fra oppgaven i denne tilstanden
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /oppgave/{oppgaveId}/kontrollert-brev:
    put:
      summary: Beslutter kvitterer ut at brev er kontrollert i gosys
      parameters:
        - in: path
          name: oppgaveId
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/KontrollertBrevRequest'
      responses:
        '204':
          description: Flagg for kontrollert brev er lagret
        '400':
          description: Feil ved parsing av request body
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        '404':
          description: Oppgaven ble ikke funnet
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        '409':
          description: Oppgaven kan ikke endre kontrollertBrev i denne tilstanden
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /oppgave/{oppgaveId}/melding-om-vedtak-kilde:
    put:
      summary: Endre kilde for melding om vedtak
      parameters:
        - in: path
          name: oppgaveId
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MeldingOmVedtakKildeRequest'
      responses:
        '204':
          description: Kilde for melding om vedtak er lagret
        '404':
          description: Oppgaven ble ikke funnet
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        '409':
          description: Oppgaven kan ikke endre kilde for melding om vedtak i denne tilstanden
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /oppgave/{oppgaveId}/send-til-kontroll:
    put:
      summary: Saksbehandler sender oppgaven til kontroll og innstiller vedtaket
      parameters:
        - in: path
          name: oppgaveId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Vellykket respons
        '404':
          description: Oppgaven ble ikke funnet
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        '409':
          description: Oppgaven kan ikke sendes til kontroll i denne tilstanden
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /oppgave/{oppgaveId}/returner-til-saksbehandler:
    put:
      summary: Beslutter sender oppgaven tilbake til saksbehandler
      parameters:
        - in: path
          name: oppgaveId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Vellykket respons
        '404':
          description: Oppgaven ble ikke funnet
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        '409':
          description: Oppgaven kan ikke returneres til saksbehandler i denne tilstanden
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /oppgave/{oppgaveId}/avbryt:
    put:
      summary: Avbryter en oppgave.
      parameters:
        - in: path
          name: oppgaveId
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AvbrytOppgave'
      responses:
        '204':
          description: Oppgaven er avbrutt
        '404':
          description: Oppgaven ble ikke funnet
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        '409':
          description: Oppgaven kan ikke avbrytes i denne tilstanden
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /oppgave/{oppgaveId}/ferdigstill:
    put:
      summary: Ferdigstill en Oppgave ved å godkjenne behandlingen og starte utsending.
      parameters:
        - in: path
          name: oppgaveId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Oppgaven er ferdig behandlet og utsending av melding om vedtak har startet
        '404':
          description: Oppgaven ble ikke funnet
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        '409':
          description: Oppgaven kan ikke ferdigstilles i denne tilstanden
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /oppgave/{oppgaveId}/utsett:
    put:
      summary: Saksbehandler utsetter oppgaven
      parameters:
        - in: path
          name: oppgaveId
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UtsettOppgave'
      responses:
        '200':
          description: Vellykket respons
        '404':
          description: Oppgaven ble ikke funnet
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        '409':
          description: Oppgaven kan ikke utsettes i denne tilstanden
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /oppgave/{oppgaveId}/tildel:
    put:
      summary: Saksbehandler blir tildelt ansvaret for oppgaven
      parameters:
        - in: path
          name: oppgaveId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Returnerer oppdatert tilstand etter tildeling av oppgave til saksbehandler eller beslutter
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TildeltOppgave'
        '404':
          description: Oppgaven ble ikke funnet
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        '409':
          description: Oppgaven kan ikke tildeles i denne tilstanden
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /oppgave/{oppgaveId}/legg-tilbake:
    put:
      summary: Saksbehandler/beslutter fjernes som ansvarlig for oppgaven, og oppgaven går tilbake til oppgavelisten
      parameters:
        - in: path
          name: oppgaveId
          required: true
          schema:
            type: string
            format: uuid
        - in: query
          name: aarsak
          required: false
          style: form
          explode: true
          schema:
            $ref: '#/components/schemas/LeggTilbakeAarsak'
      responses:
        '204':
          description: Fjernet saksbehandler/beslutter som ansvarlig for oppgaven, og oppgaven gjøres klar til behandling/kontroll
        '404':
          description: Oppgaven ble ikke funnet
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        '409':
          description: Oppgaven kan ikke legges tilbake i oppgavelisten igjen
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /klage/opprett:
    post:
      summary: Oppretter en klage fra en applikasjon (p.t. dp-mottak)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OpprettKlage'
      responses:
        '200':
          description: Vellykket oppretting av klage og tilhørende oppgave
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OppgaveOversikt'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /klage/opprett-manuelt:
    post:
      summary: Oppretter en klage fra saksbehandler
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OpprettKlage'
      responses:
        '200':
          description: Vellykket oppretting av klage og tilhørende oppgave
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OppgaveOversikt'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /klage/{behandlingId}/opplysning/{opplysningId}:
    put:
      summary: Oppdaterer opplysning i klage
      parameters:
        - in: path
          name: behandlingId
          required: true
          schema:
            type: string
            format: uuid
        - in: path
          name: opplysningId
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OppdaterKlageOpplysning'
      responses:
        '201':
          description: Vellykket oppdatering av opplysning i klage
        '404':
          description: Klagen eller opplysningen ble ikke funnet
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /klage/{behandlingId}/ferdigstill:
    put:
      summary: Ferdigstill klage
      parameters:
        - in: path
          name: behandlingId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Klagen er ferdigbehandlet
        '404':
          description: Klagen ble ikke funnet
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /klage/{behandlingId}/trekk:
    put:
      summary: Trekk klage
      parameters:
        - in: path
          name: behandlingId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Klagen er trukket
        '404':
          description: Klagen ble ikke funnet
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /klage/{behandlingId}:
    get:
      summary: Hent klage basert på behandlingId til klagen
      parameters:
        - in: path
          name: behandlingId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Vellykket respons med detaljer om klagen
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Klage'
        '404':
          description: Klagen ble ikke funnet
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /person/personId:
    post:
      summary: Hent personId basert på personIdent
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PersonIdent'
      responses:
        '200':
          description: Vellykket respons med personinformasjon
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PersonId'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /person/{personId}:
    get:
      summary: Hent personinformasjon basert på UUID
      parameters:
        - in: path
          name: personId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Vellykket respons med personinformasjon
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PersonOversikt'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /person/oppgaver:
    post:
      summary: Hent alle oppgaver til en person
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PersonIdent'
      responses:
        '200':
          description: Vellykket respons med en liste over oppgaver som samsvarer med ident
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/OppgaveOversikt'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'



  /behandling/{behandlingId}/oppgaveId:
    get:
      summary: Henter oppgaveId basert på en behandlingId
      parameters:
        - in: path
          name: behandlingId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Fant oppgaveId for behandlingId
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OppgaveId'
        '404':
          description: OppgaveId for behandlingId ble ikke funnet
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

  /behandling/{behandlingId}/sakId:
    get:
      summary: Henter sakId basert på en behandlingId
      parameters:
        - in: path
          name: behandlingId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Fant sakId for behandlingId
          content:
            text/plain:
              schema:
                type: string
                format: uuid
        '404':
          description: Fant ikke sakId for behandlingId
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'


  /produksjonsstatistikk:
    get:
      summary: Hent statistikk for oppgaver
      description: Henter statistikk for oppgaver.
      parameters:
        - in: query
          name: rettighet
          description: Filtrer på rettighet-emneknagger (f.eks. "Ordinær", "Verneplikt", "Permittert")
          required: false
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
          example: [ "Ordinær", "Verneplikt", "Permittert" ]
        - in: query
          name: tilstand
          required: false
          style: form
          explode: true
          schema:
            type: array
            items:
              $ref: '#/components/schemas/OppgaveTilstand'
        - in: query
          name: utlostAv
          required: false
          style: form
          explode: true
          schema:
            type: array
            items:
              $ref: '#/components/schemas/UtlostAvType'
        - in: query
          name: fom
          required: false
          schema:
            type: string
            format: date
        - in: query
          name: tom
          required: false
          schema:
            type: string
            format: date
        - in: query
          name: grupperEtter
          required: false
          schema:
            $ref: '#/components/schemas/GrupperEtter'

      responses:
        '200':
          description: Statistikk hentet
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Produksjonsstatistikk'
        '401':
          description: Uautorisert tilgang
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'
        default:
          description: Feil
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/HttpProblem'

components:
  schemas:
    Innsending:
      type: object
      properties:
        behandlingId:
          type: string
          format: uuid
        journalpostId:
          type: string
        lovligeSaker:
          type: array
          items:
            $ref: '#/components/schemas/TynnSak'
        sakId:
          type: string
          format: uuid
        vurdering:
          type: string
        nyBehandling:
          $ref: '#/components/schemas/TynnBehandling'
      required:
        - behandlingId
        - journalpostId
        - lovligeSaker

    TynnSak:
      type: object
      properties:
        sakId:
          type: string
          format: uuid
        opprettetDato:
          type: string
          format: date-time
      required:
        - sakId
        - opprettetDato

    TynnBehandling:
      type: object
      properties:
        behandlingId:
          type: string
          format: uuid
        behandlingType:
          $ref: '#/components/schemas/BehandlingType'
      required:
        - behandlingId
        - behandlingType

    Person:
      type: object
      properties:
        ident:
          type: string
        id:
          type: string
          format: uuid
        fornavn:
          type: string
        etternavn:
          type: string
        mellomnavn:
          type: string
        fodselsdato:
          type: string
          format: date
        alder:
          type: integer
        statsborgerskap:
          type: string
        kjonn:
          $ref: '#/components/schemas/Kjonn'
        skjermesSomEgneAnsatte:
          type: boolean
        adressebeskyttelseGradering:
          $ref: '#/components/schemas/AdressebeskyttelseGradering'
        sikkerhetstiltak:
          type: array
          items:
            $ref: '#/components/schemas/Sikkerhetstiltak'
      required:
        - ident
        - id
        - fornavn
        - etternavn
        - fodselsdato
        - alder
        - kjonn
        - skjermesSomEgneAnsatte
        - adressebeskyttelseGradering
        - sikkerhetstiltak

    PersonOversikt:
      type: object
      properties:
        person:
          $ref: '#/components/schemas/Person'
        saker:
          type: array
          items:
            $ref: '#/components/schemas/Sak'
        oppgaver:
          type: array
          items:
            $ref: '#/components/schemas/OppgaveOversikt'
      required:
        - person
        - saker
        - oppgaver

    Sak:
      type: object
      properties:
        id:
          type: string
          format: uuid
        behandlinger:
          type: array
          items:
            $ref: '#/components/schemas/Behandling'
      required:
        - id
        - behandlinger

    Behandling:
      type: object
      properties:
        id:
          type: string
          format: uuid
        behandlingType:
          $ref: '#/components/schemas/BehandlingType'
        utlostAv:
          $ref: '#/components/schemas/UtlostAvType'
        opprettet:
          type: string
          format: date-time
        oppgaveId:
          type: string
          format: uuid
      required:
        - id
        - behandlingType
        - utlostAv
        - opprettet

    OppgaveOversiktResultat:
      type: object
      properties:
        oppgaver:
          type: array
          items:
            $ref: '#/components/schemas/OppgaveOversikt'
        totaltAntallOppgaver:
          type: integer
      required:
        - oppgaver
        - totaltAntallOppgaver

    OppgaveOversikt:
      type: object
      properties:
        oppgaveId:
          type: string
          format: uuid
        behandlingId:
          type: string
          format: uuid
        personIdent:
          type: string
        behandlerIdent:
          type: string
        tidspunktOpprettet:
          type: string
          format: date-time
        behandlingType:
          $ref: '#/components/schemas/BehandlingType'
        utlostAv:
          $ref: '#/components/schemas/UtlostAvType'
        emneknagger:
          type: array
          items:
            $ref: '#/components/schemas/Emneknagg'
        skjermesSomEgneAnsatte:
          type: boolean
        adressebeskyttelseGradering:
          $ref: '#/components/schemas/AdressebeskyttelseGradering'
        tilstand:
          $ref: '#/components/schemas/OppgaveTilstand'
        lovligeEndringer:
          $ref: '#/components/schemas/LovligeEndringer'
        utsattTilDato:
          type: string
          format: date
      required:
        - oppgaveId
        - behandlingId
        - personIdent
        - tidspunktOpprettet
        - behandlingType
        - utlostAv
        - tilstand
        - emneknagger
        - adressebeskyttelseGradering
        - skjermesSomEgneAnsatte

    Oppgave:
      type: object
      properties:
        oppgaveId:
          type: string
          format: uuid
        behandlingId:
          type: string
          format: uuid
        saksbehandler:
          $ref: '#/components/schemas/Behandler'
        beslutter:
          $ref: '#/components/schemas/Behandler'
        person:
          $ref: '#/components/schemas/Person'
        tidspunktOpprettet:
          type: string
          format: date-time
        behandlingType:
          $ref: '#/components/schemas/BehandlingType'
        utlostAv:
          $ref: '#/components/schemas/UtlostAvType'
        utsattTilDato:
          type: string
          format: date
        journalpostIder:
          type: array
          items:
            type: string
        historikk:
          type: array
          items:
            $ref: '#/components/schemas/OppgaveHistorikk'
        emneknagger:
          type: array
          items:
            $ref: '#/components/schemas/Emneknagg'
        tilstand:
          $ref: '#/components/schemas/OppgaveTilstand'
        notat:
          $ref: '#/components/schemas/Notat'
        lovligeEndringer:
          $ref: '#/components/schemas/LovligeEndringer'
        soknadId:
          type: string
          format: uuid
        meldingOmVedtakKilde:
          $ref: '#/components/schemas/MeldingOmVedtakKilde'
        kontrollertBrev:
          $ref: '#/components/schemas/KontrollertBrev'
      required:
        - oppgaveId
        - behandlingId
        - person
        - tidspunktOpprettet
        - behandlingType
        - utlostAv
        - tilstand
        - emneknagger
        - lovligeEndringer
        - journalpostIder
        - historikk
        - meldingOmVedtakKilde
        - kontrollertBrev

    GrupperEtter:
      type: string
      enum:
        - RETTIGHETSTYPE
        - OPPGAVETYPE

    Kjonn:
      type: string
      enum:
        - MANN
        - KVINNE
        - UKJENT

    KontrollertBrevRequest:
      type: object
      properties:
        kontrollert:
          $ref: '#/components/schemas/KontrollertBrev'
      required:
        - kontrollert

    KontrollertBrev:
      type: string
      enum:
        - JA
        - NEI
        - IKKE_RELEVANT

    MeldingOmVedtakKildeRequest:
      type: object
      properties:
        meldingOmVedtakKilde:
          $ref: '#/components/schemas/MeldingOmVedtakKilde'

    MeldingOmVedtakKilde:
      type: string
      enum:
        - DP_SAK
        - GOSYS
        - INGEN

    Emneknagg:
      type: object
      description: |
        Emneknagg med visningsnavn og kategori. 
        Når du filtrerer oppgaver med query parameter 'emneknagg', bruk kun visningsnavnet (string).
        Responsen vil returnere fulle Emneknagg-objekter med både visningsnavn og kategori.
      properties:
        visningsnavn:
          type: string
          description: Det lesbare navnet på emneknaggen (f.eks. "Avslag", "Innvilgelse")
          example: "Avslag"
        kategori:
          $ref: '#/components/schemas/EmneknaggKategori'
      required:
        - visningsnavn
        - kategori

    EmneknaggKategori:
      type: string
      description: Kategorisering av emneknagger for enklere gruppering og filtrering i frontend
      enum:
        - RETTIGHET
        - GJENOPPTAK
        - SOKNADSRESULTAT
        - AVSLAGSGRUNN
        - AVBRUTT_GRUNN
        - PAA_VENT
        - ETTERSENDING
        - UDEFINERT



    OppgaveTilstand:
      type: string
      enum:
        - KLAR_TIL_BEHANDLING
        - UNDER_BEHANDLING
        - KLAR_TIL_KONTROLL
        - UNDER_KONTROLL
        - FERDIG_BEHANDLET
        - PAA_VENT
        - AVVENTER_LÅS_AV_BEHANDLING
        - AVVENTER_OPPLÅSING_AV_BEHANDLING
        - AVBRUTT
        - AVBRUTT_MASKINELT

    UtlostAvType:
      type: string
      enum:
        - KLAGE
        - MELDEKORT
        - SØKNAD
        - MANUELL
        - INNSENDING
        - OMGJØRING

    BehandlingType:
      type: string
      enum:
        - RETT_TIL_DAGPENGER
        - KLAGE
        - INNSENDING

    BehandlingVariant:
      type: string
      enum:
        - RETT_TIL_DAGPENGER_MANUELL
        - RETT_TIL_DAGPENGER_REVURDERING
        - KLAGE

    LovligeEndringer:
      type: object
      properties:
        paaVentAarsaker:
          type: array
          items:
            $ref: '#/components/schemas/UtsettOppgaveAarsak'
          description: Årsaker til at oppgaven settes på vent
        avbrytAarsaker:
          type: array
          items:
            $ref: '#/components/schemas/AvbrytOppgaveAarsak'
          description: Årsaker til at oppgaven avbrytes
        leggTilbakeAarsaker:
          type: array
          items:
            $ref: '#/components/schemas/LeggTilbakeAarsak'
          description: Årsaker til at oppgaven legges tilbake i oppgavelisten
      required:
        - paaVentAarsaker
        - avbrytAarsaker
        - leggTilbakeAarsaker

    AdressebeskyttelseGradering:
      type: string
      enum:
        - UGRADERT
        - FORTROLIG
        - STRENGT_FORTROLIG
        - STRENGT_FORTROLIG_UTLAND

    Sikkerhetstiltak:
      type: object
      properties:
        beskrivelse:
          type: string
        gyldigTom:
          type: string
          format: date
      required:
        - beskrivelse
        - gyldigTom

    PersonIdent:
      type: object
      properties:
        ident:
          type: string
          pattern: '^[0-9]{11}$'
      required:
        - ident

    PersonId:
      type: object
      properties:
        id:
          type: string
          format: uuid
      required:
        - id

    OppgaveId:
      type: object
      properties:
        oppgaveId:
          type: string
          format: uuid
      required:
        - oppgaveId

    OppgaveHistorikk:
      type: object
      properties:
        type:
          type: string
          enum:
            - notat
            - statusendring
        tidspunkt:
          type: string
          format: date-time
        tittel:
          type: string
        behandler:
          type: object
          properties:
            navn:
              type: string
            rolle:
              type: string
              enum:
                - saksbehandler
                - beslutter
                - system
          required:
            - navn
        body:
          type: string
      required:
        - type
        - tidspunkt
        - tittel
        - behandler

    NesteOppgave:
      type: object
      properties:
        queryParams:
          type: string
      required:
        - queryParams

    AvbrytOppgave:
      type: object
      properties:
        aarsak:
          $ref: '#/components/schemas/AvbrytOppgaveAarsak'
      required:
        - aarsak

    AvbrytOppgaveAarsak:
      type: string
      enum:
        - BEHANDLES_I_ARENA
        - FLERE_SØKNADER
        - TRUKKET_SØKNAD
        - ANNET

    LeggTilbakeAarsak:
      type: string
      enum:
        - MANGLER_KOMPETANSE
        - HABILITET
        - FRAVÆR
        - ANNET

    UtsettOppgave:
      type: object
      properties:
        utsettTilDato:
          type: string
          format: date
        beholdOppgave:
          type: boolean
        aarsak:
          $ref: '#/components/schemas/UtsettOppgaveAarsak'
      required:
        - utsettTilDato
        - beholdOppgave
        - aarsak

    UtsettOppgaveAarsak:
      type: string
      enum:
        - AVVENT_SVAR
        - AVVENT_DOKUMENTASJON
        - AVVENT_MELDEKORT
        - AVVENT_PERMITTERINGSÅRSAK
        - AVVENT_RAPPORTERINGSFRIST
        - AVVENT_SVAR_PÅ_FORESPØRSEL
        - ANNET

    LagreNotatResponse:
      type: object
      properties:
        sistEndretTidspunkt:
          type: string
          format: date-time
          description: Tidspunkt notat sist ble endret
      required:
        - sistEndretTidspunkt

    NotatRequest:
      type: object
      properties:
        tekst:
          type: string
      required:
        - tekst

    Notat:
      type: object
      properties:
        tekst:
          type: string
        sistEndretTidspunkt:
          type: string
          format: date-time
          description: Tidspunkt notat sist ble endret
      required:
        - tekst
        - sistEndretTidspunkt

    Behandler:
      type: object
      properties:
        ident:
          type: string
        fornavn:
          type: string
        etternavn:
          type: string
        enhet:
          type: object
          properties:
            navn:
              type: string
            enhetNr:
              type: string
            postadresse:
              type: string
          required:
            - navn
            - enhetNr
            - postadresse
      required:
        - ident
        - fornavn
        - etternavn
        - enhet

    Statistikk:
      type: object
      properties:
        dag:
          type: integer
          default: 0
          description: Antall behandlede oppgaver i løpet av dagen.
          example: 5
        uke:
          type: integer
          default: 0
          description: Antall behandlede oppgaver i løpet av uken.
          example: 30
        totalt:
          type: integer
          default: 0
          description: Totalt antall behandlede oppgaver.
          example: 200
      required:
        - dag
        - uke
        - totalt

    Produksjonsstatistikk:
      type: object
      properties:
        grupper:
          type: array
          items:
            $ref: '#/components/schemas/StatistikkGruppe'
        serier:
          type: array
          items:
            $ref: '#/components/schemas/StatistikkSerie'
        resultat:
          $ref: '#/components/schemas/StatistikkResultat'
      required:
        - grupper
        - serier
        - resultat

    StatistikkGruppe:
      type: object
      properties:
        navn:
          type: string
        total:
          type: integer
        eldsteOppgave:
          type: string
          format: date-time
      required:
        - navn
        - total

    StatistikkSerie:
      type: object
      properties:
        navn:
          type: string
        total:
          type: integer
      required:
        - navn
        - total

    StatistikkResultat:
      type: object
      properties:
        grupper:
          type: array
          items:
            $ref: '#/components/schemas/TilstandNavn'
        serier:
          type: array
          items:
            $ref: '#/components/schemas/StatistikkResultatSerie'
      required:
        - grupper
        - serier

    TilstandNavn:
      type: object
      properties:
        navn:
          type: string
      required:
        - navn

    StatistikkResultatSerie:
      type: object
      properties:
        navn:
          type: string
        verdier:
          type: array
          items:
            $ref: '#/components/schemas/StatistikkGruppeMedAntall'
      required:
        - navn
        - verdier

    StatistikkGruppeMedAntall:
      type: object
      properties:
        gruppe:
          type: string
        antall:
          type: integer
      required:
        - gruppe
        - antall

    BeholdningsInfo:
      type: object
      properties:
        antallOppgaverKlarTilBehandling:
          type: integer
          default: 0
          description: Antall oppgaver som er klar til behandling
        antallOppgaverKlarTilKontroll:
          type: integer
          default: 0
          description: Antall oppgaver som er klar til kontroll
        datoEldsteUbehandledeOppgave:
          type: string
          format: date-time
          description: Dato for eldste oppgave som er klar til behandling
      required:
        - antallOppgaverKlarTilBehandling
        - antallOppgaverKlarTilKontroll

    TildeltOppgave:
      type: object
      properties:
        nyTilstand:
          $ref: '#/components/schemas/OppgaveTilstand'
        behandlingType:
          $ref: '#/components/schemas/BehandlingType'
        utlostAv:
          $ref: '#/components/schemas/UtlostAvType'
      required:
        - nyTilstand
        - behandlingType
        - utlostAv

    Klage:
      type: object
      properties:
        behandlingId:
          type: string
          format: uuid
        saksbehandler:
          $ref: '#/components/schemas/Behandler'
        behandlingOpplysninger:
          type: array
          items:
            $ref: '#/components/schemas/KlageOpplysning'
        utfallOpplysninger:
          type: array
          items:
            $ref: '#/components/schemas/KlageOpplysning'
        utfall:
          $ref: '#/components/schemas/Utfall'
      required:
        - behandlingId
        - utfall
        - behandlingOpplysninger
        - utfallOpplysninger

    TekstVerdi:
      type: object
      properties:
        verdi:
          type: string
        type:
          $ref: '#/components/schemas/KlageOpplysningType'
      required:
        - verdi
        - type

    BoolskVerdi:
      type: object
      properties:
        verdi:
          type: boolean
        type:
          $ref: '#/components/schemas/KlageOpplysningType'
      required:
        - verdi
        - type

    DatoVerdi:
      type: object
      properties:
        verdi:
          type: string
          format: date
        type:
          $ref: '#/components/schemas/KlageOpplysningType'
      required:
        - verdi
        - type

    ListeVerdi:
      type: object
      properties:
        verdi:
          type: array
          items:
            type: string
        type:
          $ref: '#/components/schemas/KlageOpplysningType'
      required:
        - verdi
        - type

    OpprettKlage:
      type: object
      properties:
        opprettet:
          type: string
          format: date-time
        journalpostId:
          type: string
        sakId:
          type: string
          format: uuid
        personIdent:
          $ref: '#/components/schemas/PersonIdent'
      required:
        - opprettet
        - journalpostId
        - sakId
        - personIdent

    OppdaterKlageOpplysning:
      oneOf:
        - $ref: '#/components/schemas/TekstVerdi'
        - $ref: '#/components/schemas/BoolskVerdi'
        - $ref: '#/components/schemas/DatoVerdi'
        - $ref: '#/components/schemas/ListeVerdi'
      discriminator:
        propertyName: type
        mapping:
          TEKST: '#/components/schemas/TekstVerdi'
          BOOLSK: '#/components/schemas/BoolskVerdi'
          DATO: '#/components/schemas/DatoVerdi'
          LISTEVALG: '#/components/schemas/TekstVerdi'
          FLER_LISTEVALG: '#/components/schemas/ListeVerdi'

    KlageGruppe:
      type: string
      enum:
        - FORMKRAV
        - KLAGESAK
        - FRIST
        - KLAGE_ANKE

    KlageOpplysningTekst:
      type: object
      properties:
        opplysningId:
          type: string
          format: uuid
        opplysningNavnId:
          type: string
        navn:
          type: string
        paakrevd:
          type: boolean
        gruppe:
          $ref: '#/components/schemas/KlageGruppe'
        valgmuligheter:
          type: array
          items:
            type: string
        redigerbar:
          type: boolean
        verdi:
          type: string
        type:
          $ref: '#/components/schemas/KlageOpplysningType'
      required:
        - type
        - opplysningId
        - opplysningNavnId
        - navn
        - paakrevd
        - gruppe
        - redigerbar
        - valgmuligheter

    KlageOpplysningBoolsk:
      type: object
      properties:
        opplysningId:
          type: string
          format: uuid
        opplysningNavnId:
          type: string
        navn:
          type: string
        paakrevd:
          type: boolean
        gruppe:
          $ref: '#/components/schemas/KlageGruppe'
        valgmuligheter:
          type: array
          items:
            type: string
        redigerbar:
          type: boolean
        verdi:
          type: boolean
        type:
          $ref: '#/components/schemas/KlageOpplysningType'
      required:
        - type
        - opplysningId
        - opplysningNavnId
        - navn
        - paakrevd
        - gruppe
        - redigerbar
        - valgmuligheter

    KlageOpplysningDato:
      type: object
      properties:
        opplysningId:
          type: string
          format: uuid
        opplysningNavnId:
          type: string
        navn:
          type: string
        paakrevd:
          type: boolean
        gruppe:
          $ref: '#/components/schemas/KlageGruppe'
        valgmuligheter:
          type: array
          items:
            type: string
        redigerbar:
          type: boolean
        verdi:
          type: string
          format: date
        type:
          $ref: '#/components/schemas/KlageOpplysningType'
      required:
        - type
        - opplysningId
        - opplysningNavnId
        - navn
        - paakrevd
        - gruppe
        - redigerbar
        - valgmuligheter

    KlageOpplysningFlerListeValg:
      type: object
      properties:
        opplysningId:
          type: string
          format: uuid
        opplysningNavnId:
          type: string
        navn:
          type: string
        paakrevd:
          type: boolean
        gruppe:
          $ref: '#/components/schemas/KlageGruppe'
        valgmuligheter:
          type: array
          items:
            type: string
        redigerbar:
          type: boolean
        verdi:
          type: array
          items:
            type: string
        type:
          $ref: '#/components/schemas/KlageOpplysningType'
      required:
        - type
        - opplysningNavnId
        - opplysningId
        - navn
        - paakrevd
        - gruppe
        - redigerbar
        - valgmuligheter

    KlageOpplysningListeValg:
      type: object
      properties:
        opplysningId:
          type: string
          format: uuid
        opplysningNavnId:
          type: string
        navn:
          type: string
        paakrevd:
          type: boolean
        gruppe:
          $ref: '#/components/schemas/KlageGruppe'
        valgmuligheter:
          type: array
          items:
            type: string
        redigerbar:
          type: boolean
        verdi:
          type: string
        type:
          $ref: '#/components/schemas/KlageOpplysningType'
      required:
        - type
        - opplysningId
        - opplysningNavnId
        - navn
        - paakrevd
        - gruppe
        - redigerbar
        - valgmuligheter

    KlageOpplysningType:
      type: string
      enum:
        - TEKST
        - BOOLSK
        - DATO
        - LISTEVALG
        - FLER_LISTEVALG

    KlageOpplysning:
      oneOf:
        - $ref: '#/components/schemas/KlageOpplysningTekst'
        - $ref: '#/components/schemas/KlageOpplysningBoolsk'
        - $ref: '#/components/schemas/KlageOpplysningDato'
        - $ref: '#/components/schemas/KlageOpplysningListeValg'
        - $ref: '#/components/schemas/KlageOpplysningFlerListeValg'

      type: object
      discriminator:
        propertyName: type
        mapping:
          TEKST: '#/components/schemas/KlageOpplysningTekst'
          BOOLSK: '#/components/schemas/KlageOpplysningBoolsk'
          DATO: '#/components/schemas/KlageOpplysningDato'
          LISTEVALG: '#/components/schemas/KlageOpplysningListeValg'
          FLER_LISTEVALG: '#/components/schemas/KlageOpplysningFlerListeValg'

    Utfall:
      type: object
      properties:
        verdi:
          type: string
          enum:
            - AVVIST
            - OPPRETTHOLDELSE
            - DELVIS_MEDHOLD
            - MEDHOLD
            - IKKE_SATT
        tilgjengeligeUtfall:
          type: array
          items:
            type: string
          description: Tilgjengelige utfall for klagebehandling
      required:
        - verdi
        - tilgjengeligeUtfall

    FerdigstillInnsendingRequest:
      type: object
      properties:
        sakId:
          type: string
          format: uuid
        vurdering:
          type: string
        behandlingsvariant:
          $ref: '#/components/schemas/BehandlingVariant'
      required:
        - vurdering

    HttpProblem:
      type: object
      properties:
        type:
          type: string
        title:
          type: string
        status:
          type: integer
          format: int32
        detail:
          type: string
        instance:
          type: string
      required:
        - type
        - title
        - status
        - instance

  securitySchemes:
    azureAd:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        Bruker [AzureAD](https://docs.nais.io/security/auth/azure-ad) til autentisering. 
        Token må ha `audience` satt til `[cluster].teamdagpenger.dp-saksbehandling`.
        
        For å teste APIet kan du lage et gyldig OBO-token ved å bruke wonderwalled:
        - [dev-gcp](https://azure-token-generator.intern.dev.nav.no/api/obo?aud=dev-gcp.teamdagpenger.dp-saksbehandling)
